<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="assets/apple-touch-icon.png" type="image/png">
    <link rel="stylesheet" href="css/main.css">
    <script src="https://kit.fontawesome.com/cf03def005.js" crossorigin="anonymous"></script>
    <title>Admin Profile ::MY Brand</title>
</head>

<body id="body">
    <nav class="w-100 flex align-center">
        <div class="lg">
            <a href="#" class="logo">Tresor</a>
            <small>admin</small>
        </div>
        <div id="toggler" class="profile">
            <div class="userProfile fa-solid fa-user-circle"></div>
        </div>
    </nav>
    <div id="menus" class="menuUser">
        <a href="profile.html"><span class="fa-solid fa-user-cog"></span> Profile</a>
        <a href="#" class="logout" onclick="logout();"><span class="fa-solid fa-right-from-bracket"></span> Logout</a>
    </div>
    <div id="admin" class="w-100 flex">
        <div class="sidebar flex w-25">
            <ul>
                <li><a href="admin.html">Dashboard</a></li>
                <li><a href="#">Blog Owners</a></li>
                <li class="active"><a href="profile.html">Profile</a></li>
            </ul>
        </div>
        <div class="main-content w-75">
            <h4><small>admin/</small> <strong>Profile</strong></h4>
            <div class="cards flex w-100">
                <form action="#">
                    <p id="log"></p>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" required placeholder="Your Email" id="em">
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" required placeholder="Your Password" id="ps">
                    </div>
                    <button type="button" id="check">Save Changes</button>
                </form>
            </div>
        </div>
    </div>

    <script src="js/main.js"></script>
    <script>
        let email = document.cookie.slice(5);
        let emInput = document.getElementById('em');
        let log = document.getElementById('log');
        let ps = document.getElementById('ps');
        let checkBtn = document.getElementById('check');
        window.addEventListener('DOMContentLoaded', () => {
            emInput.value = email
        })

        let toggler = document.getElementById('toggler');
        if (localStorage.getItem('accounts')) {
            var users = JSON.parse(localStorage.getItem('accounts'));
        } else {
            console.log('Data not captured!');
            var users = [];
        }
        checkBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (emInput.value == '' || ps.value == '') {
                log.innerHTML = 'Please fill the form';
            } else {
                for (let i = 0; i< users.length; i++) {
                    let person = users[i]
                    if (person.email == email) {
                        users[i] = {
                            email: email,
                            pwd: ps.value
                        }
                        localStorage.setItem('accounts', JSON.stringify(users));
                        log.innerHTML = "Your credential saved";
                    } else {
                        log.innerHTML = 'No account found';
                    }
                }
            }
        })
        
        let logout = () => {
            let loggedOutUser = document.cookie;
            document.cookie = `user=${loggedOutUser.slice(5)}; expires=Thu 20 Nov 2020 12:00:00 UTC`;
            window.location.href = 'index.html#sign-in';
        }

        toggler.addEventListener('click', () => {
            menus.classList.toggle('toggled');
        });
    </script>
</body>

</html>